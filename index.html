<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>カウント表示</title>
  <style>
    /* ページ全体を中央揃え */
    body {
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      height: 100vh;
      margin: 0;
      background-color: #f0f0f0;
      font-family: Arial, sans-serif;
    }

    /* カウント表示を大きく */
    #output {
      font-size: 25rem;
      font-weight: bold;
      color: #333;
      transition: transform 0.3s ease;
    }

    /* 跳ねるアニメーション */
    .bounce {
      animation: bounce 0.5s ease;
    }

    @keyframes bounce {
      0%   { transform: scale(1); }
      30%  { transform: scale(1.5); }
      50%  { transform: scale(0.9); }
      70%  { transform: scale(1.2); }
      100% { transform: scale(1); }
    }

    /*
    #status {
      font-size: 1.5rem;
      margin-bottom: 20px;
      color: #555;
    }
    */
    #status {
      position: fixed;
      bottom: 10px;
      right: 10px;
      font-size: 14px;
      color: #666;
      text-align: right;
    }

  </style>
</head>
<body>
  <div id="output">0</div>
  <div id="status">接続中...</div>
  <script>
    const status = document.getElementById("status");
    const output = document.getElementById("output");

    const coinSound = new Audio("sound/he.mp3");
    const ws = new WebSocket("ws://localhost:8000");

    ws.onopen = () => {
      status.textContent = "✅ サーバーに接続しました";
    };

    ws.onmessage = (event) => {
      // 数字が変わったらアニメーションを追加
      output.textContent = event.data;

      coinSound.currentTime = 0; // 途中ならリセット
      coinSound.play();

      output.classList.remove("bounce");
      void output.offsetWidth; // 再描画でアニメーションをリセット
      output.classList.add("bounce");
      
    };

    ws.onerror = (err) => {
      status.textContent = "❌ エラー発生";
      console.error("WebSocket error:", err);
    };

    ws.onclose = () => {
      status.textContent = "🔌 接続終了";
    };
  </script>
</body>
</html>
