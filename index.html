<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>ã‚«ã‚¦ãƒ³ãƒˆè¡¨ç¤º</title>
  <style>
    /* ãƒšãƒ¼ã‚¸å…¨ä½“ã‚’ä¸­å¤®æƒãˆ */
    body {
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      height: 100vh;
      margin: 0;
      background-color: #f0f0f0;
      font-family: Arial, sans-serif;
    }

    /* ã‚«ã‚¦ãƒ³ãƒˆè¡¨ç¤ºã‚’å¤§ãã */
    #output {
      font-size: 25rem;
      font-weight: bold;
      color: #333;
      transition: transform 0.3s ease;
    }

    /* è·³ã­ã‚‹ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ */
    .bounce {
      animation: bounce 0.5s ease;
    }

    @keyframes bounce {
      0%   { transform: scale(1); }
      30%  { transform: scale(1.5); }
      50%  { transform: scale(0.9); }
      70%  { transform: scale(1.2); }
      100% { transform: scale(1); }
    }

    /*
    #status {
      font-size: 1.5rem;
      margin-bottom: 20px;
      color: #555;
    }
    */
    #status {
      position: fixed;
      bottom: 10px;
      right: 10px;
      font-size: 14px;
      color: #666;
      text-align: right;
    }

  </style>
</head>
<body>
  <div id="output">0</div>
  <div id="status">æ¥ç¶šä¸­...</div>
  <script>
    const status = document.getElementById("status");
    const output = document.getElementById("output");

    const coinSound = new Audio("sound/he.mp3");
    const ws = new WebSocket("ws://localhost:8000");

    ws.onopen = () => {
      status.textContent = "âœ… ã‚µãƒ¼ãƒãƒ¼ã«æ¥ç¶šã—ã¾ã—ãŸ";
    };

    ws.onmessage = (event) => {
      // æ•°å­—ãŒå¤‰ã‚ã£ãŸã‚‰ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’è¿½åŠ 
      output.textContent = event.data;

      coinSound.currentTime = 0; // é€”ä¸­ãªã‚‰ãƒªã‚»ãƒƒãƒˆ
      coinSound.play();

      output.classList.remove("bounce");
      void output.offsetWidth; // å†æç”»ã§ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ãƒªã‚»ãƒƒãƒˆ
      output.classList.add("bounce");
      
    };

    ws.onerror = (err) => {
      status.textContent = "âŒ ã‚¨ãƒ©ãƒ¼ç™ºç”Ÿ";
      console.error("WebSocket error:", err);
    };

    ws.onclose = () => {
      status.textContent = "ğŸ”Œ æ¥ç¶šçµ‚äº†";
    };
  </script>
</body>
</html>
